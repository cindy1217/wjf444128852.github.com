<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
    <!-- 启用webAPP全屏模式-->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!-- 隐藏状态栏或者设置状态栏的颜色-->
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!-- 忽略数字自动识别为电话号码-->
    <meta name="format-detection" content="telephone=no">
    <!--控制缓存的失效日期 -->
    <meta http-equiv="Expires" content="-1">
    <!-- 禁止转码-->
    <meta http-equiv="Cache-Control" content="no-cache">
    <!-- 禁止缓存访问页面-->
    <meta http-equiv="Pragma" content="no-cache">
    <meta name="applicable-device" content="mobile">
    <!-- 页面关键词-->
    <meta content="" name="keywords">
    <meta name="description" content="">
    <base target="_blank">
    <!--自适应控制JS必须存在-->
    <!--<script src="js/mobile-adaptive.js"></script>-->
    <!--默认样式重置-->
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/index.css">
    <script src="js/jquery-1.9.1.min.js"></script>
    <script src="js/iscroll.js"></script>
    <title>iScroll上拉刷新，下拉加载</title>
</head>
<body>
    <div id="wrapper">
    <div id="scroller">
        <div id="scroller-pullDown">
            <span id="down-icon" class="pull-down-icon">11</span>
            <span id="pullDown-msg" class="pull-down-msg">下拉刷新</span>
        </div>
        <div id="scroller-content">
            <ul>
                <li>Pretty row 1</li>
                <li>Pretty row 2</li>
                <li>Pretty row 3</li>
                <li>Pretty row 4</li>
                <li>Pretty row 5</li>
                <li>Pretty row 6</li>
                <li>Pretty row 7</li>
                <li>Pretty row 8</li>
                <li>Pretty row 9</li>
                <li>Pretty row 10</li>
                <li>Pretty row 11</li>
                <li>Pretty row 12</li>
                <li>Pretty row 13</li>
                <li>Pretty row 14</li>
                <li>Pretty row 15</li>
                <li>Pretty row 16</li>
                <li>Pretty row 17</li>
                <li>Pretty row 18</li>
                <li>Pretty row 19</li>
                <li>Pretty row 20</li>
                <li>Pretty row 21</li>
                <li>Pretty row 22</li>
                <li>Pretty row 23</li>
                <li>Pretty row 24</li>
                <li>Pretty row 25</li>
                <li>Pretty row 26</li>
                <li>Pretty row 27</li>
                <li>Pretty row 28</li>
                <li>Pretty row 29</li>
                <li>Pretty row 30</li>
                <li>Pretty row 31</li>
                <li>Pretty row 32</li>
                <li>Pretty row 33</li>
                <li>Pretty row 34</li>
                <li>Pretty row 35</li>
                <li>Pretty row 36</li>
                <li>Pretty row 37</li>
                <li>Pretty row 38</li>
                <li>Pretty row 39</li>
                <li>Pretty row 40</li>
                <li>Pretty row 41</li>
                <li>Pretty row 42</li>
                <li>Pretty row 43</li>
                <li>Pretty row 44</li>
                <li>Pretty row 45</li>
                <li>Pretty row 46</li>
                <li>Pretty row 47</li>
                <li>Pretty row 48</li>
                <li>Pretty row 49</li>
                <li>Pretty row 50</li>
            </ul>
        </div>
        <div id="scroller-pullUp">
            <span id="up-icon" class="pull-up-icon">22</span>
            <span id="pullUp-msg" class="pull-up-msg">上拉刷新</span>
        </div>
    </div>
</div>
    <script>
        function loaded () {
            var myScroll,
                    //上拉提示标志
                    upIcon = $("#up-icon"),
                    //下拉提示标志
                    downIcon = $("#down-icon");
            // 滚动对象
            myScroll = new IScroll('#wrapper', { probeType: 3, mouseWheel: true });
            // 滚动事件
            //probeType属性，表明此插件，可以监听scroll事件
            //scroll事件，可以用来控制上拉和下拉之后显示的模块中，
            //样式和内容展示的部分的改变。
            myScroll.on("scroll",function(){
                var y = this.y,
                        maxY = this.maxScrollY - y,
                        downHasClass = downIcon.hasClass("reverse_icon"),
                        upHasClass = upIcon.hasClass("reverse_icon");

                if(y >= 40){
                    !downHasClass && downIcon.addClass("reverse_icon");
                    return "";
                }else if(y < 40 && y > 0){
                    downHasClass && downIcon.removeClass("reverse_icon");
                    return "";
                }
                if(maxY >= 40){
                    !upHasClass && upIcon.addClass("reverse_icon");
                    return "";
                }else if(maxY < 40 && maxY >=0){
                    upHasClass && upIcon.removeClass("reverse_icon");
                    return "";
                }
            });
            myScroll.on("slideDown",function(){
                //当下拉，使得边界超出时，如果手指从屏幕移开，则会触发该事件
                if(this.y > 40){
                    //获取内容于屏幕拉开的距离
                    //可以在该部分中，修改样式，并且仅限ajax或者其他的一些操作
                    //此时只是为了能演示该功能，只添加了一个alert功能。
                    //并且，由于alert会阻塞后续的动画效果，所以，
                    //添加了后面的一行代码，移除之前添加上的一个样式
                    alert("slideDown");
                    upIcon.removeClass("reverse_icon")
                }
            });
            myScroll.on("slideUp",function(){
                if(this.maxScrollY - this.y > 40){
                    //与slideDown相同的，maxScrollY表示文档区域的最大高度
                    alert("slideUp");
                    upIcon.removeClass("reverse_icon")
                }
            });
        }

        window.onload=function(){
            loaded ();
        }
    </script>
</body>
</html>