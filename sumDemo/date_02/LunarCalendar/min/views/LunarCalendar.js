(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define(["jquery","util","handlebars","Templates","CalendarView"],function(t,n,r,i,s){var o;return o=function(){function r(){this.getNewInfo=e(this.getNewInfo,this),this.initialize()}return r.prototype.weather_style={0:"qing",1:"duoyun",2:"yintian",3:"leizhenyu",4:"leizhenyu",5:"zhenyubingbao",6:"dongyu",7:"xiaoyu",8:"zhongyu",9:"dayu",10:"baoyu",11:"baoyu",12:"baoyu",13:"leizhenyu",14:"xiaoxue",15:"zhongxue",16:"daxue",17:"baoxue",18:"wu",19:"dongyu",20:"shachenbao",22:"zhongyu",23:"zhongyu",24:"dayu",25:"baoyu",26:"zhongxue",27:"daxue",28:"baoxue",29:"shachenbao",30:"shachenbao",31:"shachenbao",53:"wumai",99:"qing"},r.prototype.initialize=function(){return this.btnPrev=t("#jsPrevMonth"),this.btnNext=t("#jsNextMonth"),this.btnReturnToday=t("#jsReturnTodayBtn"),this.labLunarCalendar=t("#jsLunarcalendarLab"),this.labGregorian=t("#jsGregorianLab"),this.calendarPanel=t("#calendarPanel"),this.labTime=t("#jstimeLab"),this.labYearMonth=t("#jsYearMonthLab"),this.newsEL=t("#jsNewList"),this.cityTemperature=t("#city_temperature"),this.cityInfo=t("#city_info"),this.currentDate=new Date,this.timer=0,this.initCalendar().eventBinds().getCityWeatherInfo(),this},r.prototype.initCalendar=function(){var e,t,n,r,o,u;this.labTime.html(this.getTime(this.timer)),window.setInterval(function(e){return function(){return e.labTime.html(e.getTime(e.timer)),e.timer++}}(this),999),t,n=0,o="";while(n<6){r=0;while(r<7)t=n*7+r,o+=i.DAY_ITEM({index:t}),r++;n++}return this.calendarPanel.html(o),window.yftoutiao=this.getNewInfo,u=""+this.currentDate.getFullYear()+this.currentDate.getMonth()+this.currentDate.getDate(),require(["http://s.yunfan.com/js/client/api/yftoutiao.js?"+u]),e=new s,this},r.prototype.getTime=function(e){var t,r;return this.currentDate=new Date,r=e%2===0?"{0}:{1}":"{0} {1}",t=this.currentDate.getMinutes()<10?n.format("0{0}",this.currentDate.getMinutes()):this.currentDate.getMinutes(),n.format(r,this.currentDate.getHours(),t)},r.prototype.is_leap=function(e){return!1},r.prototype.eventBinds=function(){return t(document.body).delegate("a.jsNews","click",function(){var e,n,r,i,s,o,u,a;return a=t(this).attr("href"),r=encodeURIComponent(a),n="yingku.rili."+t(this).attr("index"),s=Date.parse(new Date)/1e3,i=encodeURIComponent(t(this).text()),e="http%3A%2F%2Fyingku.yunfan.com%2F",u="http://ulog.s.yunfan.com/analy/?RID=&FU=&NU="+r+"&TM="+s+"&ED="+n+"&CP=&CU="+e+"&DU=&GID=&PID=&AID=&IID=&CID=&TI="+i,o=document.getElementById("client_send_tj"),o||(o=document.createElement("img"),o.id="client_send_tj",document.body.appendChild(o)),o.src=u}),this},r.prototype.getNewInfo=function(e){return this.newsEL.html(i.NEWS_ITEM({data:e.small.slice(0,5)})),this},r.prototype.getCityWeatherInfo=function(){return uIPData&&n.get({url:"http://cal.yunfan.com/calendar/weather/"+uIPData.code+".json",success:function(e){return function(n,r){var s;if(n)return e.cityTemperature.html(""+n.weatherinfo.st1+"â„ƒ"),e.cityInfo.html(i.CITY_TPL({city:n.weatherinfo.city,weather1:n.weatherinfo.weather1,temp1:n.weatherinfo.temp1,SD:n.weatherinfo.SD,pm2_5:n.pm25.pm2_5,quality:n.pm25.quality})),s=n.weatherinfo.img_single,t(".temperature .icon").addClass(e.weather_style[s])}}(this),error:function(e){return function(e,t){return!1}}(this)}),this},r}()})}).call(this);